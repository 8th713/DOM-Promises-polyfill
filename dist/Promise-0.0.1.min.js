/*! dom-promises-polyfill 0.0.1
 * (c) 2013 8th713 <https://github.com/8th713>
 * License: MIT 
 */
!function(a){"use strict";function b(a){return Array.prototype.slice.call(a,1)}function c(a,b){for(var c;c=a.shift();)c(b)}function d(a){return"function"==typeof a}function e(a){return a&&a.then&&d(a.then)}function f(a,b,c,e){return d(a)?function(d){try{b.resolve(a.call(c,d))}catch(e){b.reject(e)}}:function(a){b[e](a)}}function g(a){var b,c=[],d=a.length;for(b=0;d>b;b++)c.push(i.resolve(a[b]));return c}function h(a,b,d,f){function g(b){d("fulfilled"),f(b),j(c,a,b)}function h(a){d("rejected"),f(a),j(c,b,a)}function i(a){return e(a)?(a.then(i,h),void 0):(g(a),void 0)}function k(a){return function(b){l||(l=!0,a(b))}}var l=!1;this.fulfill=k(g),this.resolve=k(i),this.reject=k(h)}function i(a){if(!a)throw new TypeError("Not enough arguments");if(!d(a))throw new TypeError("Init argument must be a function");var b,e=this,g=[],k=[],l="pending";e.then=function(a,d){return new i(function(h){var i=f(a,h,e,"resolve"),m=f(d,h,e,"reject");g.push(i),"fulfilled"==l&&j(c,g,b),k.push(m),"rejected"==l&&j(c,k,b)})},e.catch=function(a){return e.then(null,a)};var m=new h(g,k,function(a){l=a},function(a){b=a});try{a.call(e,m)}catch(n){m.reject(n)}}var j=function(){var a,c;return"undefined"!=typeof process?function(a){var c=b(arguments);process.nextTick(function(){a.apply(null,c)})}:"function"==typeof setImmediate?function(a){var c=b(arguments);window.setImmediate(a,c)}:"function"==typeof MessageChannel?(a=new MessageChannel,c=[],a.port1.onmessage=function(){for(var a;a=c.shift();)a.callback.apply(null,a.args)},function(d){c.push({callback:d,args:b(arguments)}),a.port2.postMessage(0)}):function(a){var c=b(arguments);setTimeout(function(){a.apply(null,c)},0)}}();i.fulfill=function(a){return new i(function(b){b.fulfill(a)})},i.resolve=function(a){return new i(function(b){b.resolve(a)})},i.reject=function(a){return new i(function(b){b.reject(a)})},i.any=function(){var a=g(arguments);return new i(function(b){function c(a){e||(e=!0,b.resolve(a))}function d(a){e||(e=!0,b.reject(a))}if(!a.length)return b.resolve(),void 0;for(var e=!1,f=0,g=a.length;g>f;f++)a[f].then(c,d)})},i.every=function(){var a=g(arguments);return new i(function(b){function c(a){return function(c){d-=1,e[a]=c,d||b.resolve(e)}}var d=a.length;if(!d)return b.resolve(),void 0;for(var e=new Array(d),f=0;d>f;f++)a[f].then(c(f),b.reject)})},i.some=function(){var a=g(arguments);return new i(function(b){function c(a){return function(c){d-=1,e[a]=c,d||b.reject(e)}}var d=a.length;if(!a.length)return b.resolve(),void 0;for(var e=new Array(d),f=0,g=a.length;g>f;f++)a[f].then(b.resolve,c(f))})},"object"==typeof exports?module.exports=i:void 0===a.Promise&&(a.Promise=i)}(this.self);